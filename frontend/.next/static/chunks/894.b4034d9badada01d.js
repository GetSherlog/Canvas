"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[894],{17894:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var l=s(90702),r=s(16606),a=s(31748),n=s(43466),i=s(74508),o=s(6626),d=s(20597),c=s(37503),m=s(50738),x=s(71008),u=s(65619),h=s(47392),g=s(57530),f=s(12390),p=s(10964),b=s(83994),j=s(33771);let N=r.memo(e=>{var t;let{cell:s,onUpdate:N,onExecute:v,onDelete:y,isExecuting:w}=e,[S,C]=(0,r.useState)(s.tool_name||""),[_,k]=(0,r.useState)(s.tool_arguments||{}),[A,F]=(0,r.useState)(!0),[E,T]=(0,r.useState)({}),R=(0,j.d)(e=>e.toolDefinitions.filesystem),q=(0,j.d)(e=>e.toolLoadingStatus.filesystem),V=null==R?void 0:R.find(e=>e.name===S);(0,r.useEffect)(()=>{console.log("[FileSystemCell ".concat(s.id,"] useEffect [id changed]: Syncing state from props.")),C(s.tool_name||""),k(s.tool_arguments?{...s.tool_arguments}:{})},[s.id,s.tool_name,s.tool_arguments]);let O=(e,t)=>{k(l=>{let r={...l,[e]:t};return console.log("[FileSystemCell ".concat(s.id,"] Arg changed: ").concat(e,", New Value:"),t,"New Args State:",r),N(s.id,s.content,{toolName:S,toolArgs:r}),r})},H=e=>{if(!e||"string"!=typeof e||!e.includes("\n")&&!e.includes("\r")&&!e.includes(","))return null;let t=e.trim().split(/\r?\n/);if(0===t.length)return null;try{return t.map(e=>e.split(",").map(e=>e.trim()))}catch(e){return console.error("CSV parsing failed:",e),null}},z=(e,t)=>{if(!e||0===e.length)return(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"Empty CSV data."});let r=e[0],a=e.slice(1),i=a.length,o=!1;return void 0!==t&&a.length>t&&(a=a.slice(0,t),o=!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"overflow-x-auto border rounded-md max-h-[400px]",children:(0,l.jsxs)(b.XI,{className:"min-w-full text-xs",children:[(0,l.jsx)(b.A0,{className:"bg-gray-50 sticky top-0",children:(0,l.jsx)(b.Hj,{children:r.map((e,t)=>(0,l.jsx)(b.nd,{className:"px-2 py-1.5 font-medium text-gray-600 whitespace-nowrap",children:e},t))})}),(0,l.jsxs)(b.BF,{children:[a.map((e,t)=>(0,l.jsx)(b.Hj,{children:e.map((e,t)=>(0,l.jsx)(b.nA,{className:"px-2 py-1.5 whitespace-nowrap",children:e},t))},t)),0===a.length&&(0,l.jsx)(b.Hj,{children:(0,l.jsx)(b.nA,{colSpan:r.length,className:"text-center text-gray-500 py-4",children:"No data rows found."})})]})]})}),o&&(0,l.jsxs)("div",{className:"text-xs text-gray-600 mt-2 flex justify-between items-center",children:[(0,l.jsxs)("span",{children:["Showing first ",t," of ",i," data rows."]}),(0,l.jsx)(n.$,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-blue-600 hover:text-blue-800",onClick:()=>{var e,t;if("string"==typeof(null===(e=s.result)||void 0===e?void 0:e.content)){if("read_file"===s.tool_name&&(null===(t=s.tool_arguments)||void 0===t?void 0:t.target_file)){let e=s.tool_arguments.target_file,t="/view-csv?filePath=".concat(encodeURIComponent(e));window.open(t,"_blank")}else{console.warn("Cannot view full file: Tool is not 'read_file' (actual: ".concat(s.tool_name,") or 'target_file' argument is missing in cell.tool_arguments (args: ").concat(JSON.stringify(s.tool_arguments),"). Trying sessionStorage fallback..."));try{sessionStorage.setItem("fullCsvData",s.result.content),window.open("/view-csv","_blank"),alert("Opening file view without a direct path. This might not work as expected.")}catch(e){console.error("Failed to store CSV data in sessionStorage:",e),alert("Could not open full view: Data might be too large for session storage or file path is unavailable.")}}}else console.warn("Cannot view full file: Result content is not a string."),alert("Could not open full view: The result content is not in a viewable format.")},title:"View the full CSV file in a new tab",children:"View Full File"})]})]})};return(0,l.jsxs)("div",{className:"border rounded-md overflow-hidden mb-3 mx-8",children:[(0,l.jsxs)("div",{className:"p-2 flex justify-between items-center border-b ".concat("bg-blue-100"," ").concat("border-blue-200"),children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(i.A,{className:"h-4 w-4 mr-2 text-blue-700 flex-shrink-0"}),(0,l.jsx)("span",{className:"font-medium text-sm text-blue-800",children:S||"Filesystem Command"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-1.5",children:[(0,l.jsxs)(n.$,{size:"sm",variant:"outline",className:"bg-white hover:bg-blue-50 border-blue-300 h-7 px-2 text-xs",onClick:()=>{console.log("[FileSystemCell ".concat(s.id,"] Executing with Tool: ").concat(S,", Args:"),_),N(s.id,s.content,{toolName:S,toolArgs:_}),v(s.id)},disabled:w||!S,title:"Execute Cell",children:[(0,l.jsx)(o.A,{className:"h-3.5 w-3.5 mr-1 text-blue-700"}),w?"Running...":"Run Command"]}),(0,l.jsx)(u.Bc,{delayDuration:100,children:(0,l.jsxs)(u.m_,{children:[(0,l.jsx)(u.k$,{asChild:!0,children:(0,l.jsx)(n.$,{size:"sm",variant:"ghost",className:"text-gray-500 hover:bg-red-100 hover:text-red-700 h-7 w-7 px-0",onClick:()=>{y(s.id)},disabled:w,children:(0,l.jsx)(d.A,{className:"h-4 w-4"})})}),(0,l.jsx)(u.ZI,{children:(0,l.jsx)("p",{children:"Delete Cell"})})]})})]})]}),(0,l.jsxs)("div",{className:"p-3",children:[(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)(x.Zp,{className:"border-blue-200",children:(0,l.jsx)(x.Wu,{className:"p-3",children:(0,l.jsx)(p.nD,{type:"single",collapsible:!0,defaultValue:"item-1",className:"w-full",children:(0,l.jsxs)(p.As,{value:"item-1",className:"border-b-0",children:[(0,l.jsxs)(p.$m,{className:"text-xs font-medium py-2 hover:no-underline",children:["Command Arguments (",S||"No tool selected",")"]}),(0,l.jsx)(p.ub,{className:"pt-2",children:S?(()=>{if(console.log("[FileSystemCell ".concat(s.id,"] Rendering inputs for: ").concat(S)),console.log("[FileSystemCell ".concat(s.id,"] Filesystem Tool loading status:"),q),console.log("[FileSystemCell ".concat(s.id,"] Available Filesystem tool definitions:"),R),void 0===q||"idle"===q)return(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"Initializing tool definitions..."});if("loading"===q)return(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"Loading tool parameters..."});if("error"===q)return(0,l.jsx)("div",{className:"text-xs text-red-500",children:"Error loading tool definitions."});if(!V)return S&&"success"===q?(0,l.jsxs)("div",{className:"text-xs text-red-500",children:["Tool definition not found for: ",S]}):(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"Select a filesystem tool."});let e=V.inputSchema,t=null==e?void 0:e.properties,r=new Set((null==e?void 0:e.required)||[]);if(!t||0===Object.keys(t).length)return(0,l.jsx)("div",{className:"text-xs text-gray-600 mb-3",children:"This tool requires no arguments."});let n=(e,t)=>{var n,i,o;let d="".concat(e,"-").concat(s.id),c=t.title||e,m=r.has(e),x=t.description,u=null!==(o=null!==(i=_[e])&&void 0!==i?i:t.default)&&void 0!==o?o:"",p=(null===(n=t.examples)||void 0===n?void 0:n[0])||t.description||"Enter ".concat(c),b=null,j=t.type,N=t.format,v=t.enum;return b=v&&Array.isArray(v)?(0,l.jsxs)(f.l6,{value:String(u),onValueChange:t=>O(e,t),required:m,children:[(0,l.jsx)(f.bq,{id:d,className:"mt-1 h-8 text-xs",children:(0,l.jsx)(f.yv,{placeholder:p})}),(0,l.jsx)(f.gC,{children:v.map(e=>(0,l.jsx)(f.eb,{value:e,children:e},e))})]}):"string"===j&&("textarea"===N||x&&x.length>50)?(0,l.jsx)(a.T,{id:d,value:String(u),onChange:t=>O(e,t.target.value),placeholder:p,required:m,className:"mt-1 h-16 text-xs font-mono resize-none"}):"number"===j||"integer"===j?(0,l.jsx)(g.p,{id:d,type:"number",value:String(u),onChange:t=>O(e,""===t.target.value?"":Number(t.target.value)),placeholder:p,required:m,min:t.minimum,max:t.maximum,step:t.multipleOf||"any",className:"mt-1 h-8 text-xs"}):"boolean"===j?(0,l.jsx)("div",{className:"flex items-center space-x-2 mt-1 h-8",children:(0,l.jsx)("input",{type:"checkbox",id:d,checked:!!u,onChange:t=>O(e,t.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}):(0,l.jsx)(g.p,{id:d,type:"text",value:String(u),onChange:t=>O(e,t.target.value),placeholder:p,required:m,className:"mt-1 h-8 text-xs font-mono"}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsxs)(h.J,{htmlFor:d,className:"text-xs text-gray-700",children:[c," ",m&&(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),b,x&&(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:x})]},d)};return(0,l.jsx)("div",{className:"space-y-2",children:Object.entries(t).map(e=>{let[t,s]=e;return n(t,s)})})})():(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"No tool selected or definition available."})})]})})})})}),"running"===s.status&&(0,l.jsxs)("div",{className:"flex items-center text-xs text-amber-600 mb-3",children:[(0,l.jsx)("div",{className:"animate-spin h-3 w-3 border-2 border-amber-600 rounded-full border-t-transparent mr-1.5"}),"Executing command..."]}),"queued"===s.status&&(0,l.jsxs)("div",{className:"flex items-center text-xs text-blue-600 mb-3",children:[(0,l.jsx)("div",{className:"h-3 w-3 bg-blue-600 rounded-full mr-1.5 animate-pulse"}),"Queued for execution..."]}),"stale"===s.status&&(0,l.jsxs)("div",{className:"flex items-center text-xs text-gray-600 mb-3",children:[(0,l.jsx)("div",{className:"h-3 w-3 border border-gray-600 rounded-full mr-1.5"}),"Stale (needs re-run)..."]}),"error"===s.status&&(null===(t=s.result)||void 0===t?void 0:t.error)&&(0,l.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-2 mb-3 text-red-700",children:[(0,l.jsx)("div",{className:"font-medium text-xs",children:"Execution Error:"}),(0,l.jsx)("pre",{className:"whitespace-pre-wrap text-xs mt-0.5 font-mono",children:s.result.error})]}),"queued"!==s.status&&"running"!==s.status&&s.result&&(0,l.jsxs)(x.Zp,{className:"border ".concat("border-blue-200"),children:[(0,l.jsxs)(x.aR,{className:"flex flex-row items-center justify-between p-2 ".concat("bg-blue-50"),children:[(0,l.jsx)(x.ZB,{className:"text-sm font-semibold text-blue-800",children:"Execution Result"}),(0,l.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>F(!A),className:"text-xs",children:A?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.A,{className:"h-4 w-4 mr-1"})," Hide"]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.A,{className:"h-4 w-4 mr-1"})," Show"]})})]}),A&&(0,l.jsx)(x.Wu,{className:"p-2 border-t",children:(0,l.jsxs)("div",{className:"mt-1 rounded overflow-x-auto max-h-[450px]",children:[(e=>{if(console.log("[FileSystemCell] renderFileSystemResult received content type:",typeof e),"string"==typeof e){let t=H(e);if(t)return z(t,10)}return Array.isArray(e)&&e.every(e=>"string"==typeof e)?0===e.length?(0,l.jsx)("p",{className:"text-xs text-gray-500 p-1.5",children:"Empty list."}):(0,l.jsx)("ul",{className:"list-none p-1.5 text-xs font-mono bg-white border border-gray-200 rounded max-h-[400px] overflow-auto",children:e.map((e,t)=>(0,l.jsx)("li",{className:"whitespace-pre-wrap break-words",children:e},t))}):(0,l.jsx)("pre",{className:"text-xs whitespace-pre-wrap break-words font-mono bg-white p-1.5 border border-gray-200 rounded max-h-[400px] overflow-auto",children:e&&"object"==typeof e?JSON.stringify(e,null,2):String(null!=e?e:"")})})(s.result.content),void 0!==s.result.execution_time&&(0,l.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Execution Time: ",s.result.execution_time.toFixed(2),"s"]})]})})]}),("queued"===s.status||"running"===s.status)&&!s.result&&(0,l.jsxs)("div",{className:"p-2 text-xs text-gray-500 flex items-center",children:[(0,l.jsx)("div",{className:"animate-spin h-3 w-3 border-2 border-gray-400 rounded-full border-t-transparent mr-1.5"}),"Processing..."]})]})]})},(e,t)=>{let s=e.cell,l=t.cell;return s===l&&e.isExecuting===t.isExecuting||e.isExecuting===t.isExecuting&&s.id===l.id&&s.status===l.status&&s.tool_name===l.tool_name&&s.result===l.result&&JSON.stringify(s.tool_arguments)===JSON.stringify(l.tool_arguments)})},83994:(e,t,s)=>{s.d(t,{A0:()=>i,BF:()=>o,Hj:()=>d,XI:()=>n,nA:()=>m,nd:()=>c});var l=s(90702),r=s(16606),a=s(79321);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,l.jsx)("div",{className:"relative w-full overflow-auto",children:(0,l.jsx)("table",{ref:t,className:(0,a.cn)("w-full caption-bottom text-sm",s),...r})})});n.displayName="Table";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,l.jsx)("thead",{ref:t,className:(0,a.cn)("[&_tr]:border-b",s),...r})});i.displayName="TableHeader";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,l.jsx)("tbody",{ref:t,className:(0,a.cn)("[&_tr:last-child]:border-0",s),...r})});o.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,l.jsx)("tfoot",{ref:t,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,l.jsx)("tr",{ref:t,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});d.displayName="TableRow";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,l.jsx)("th",{ref:t,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});c.displayName="TableHead";let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,l.jsx)("td",{ref:t,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});m.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,l.jsx)("caption",{ref:t,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption"}}]);