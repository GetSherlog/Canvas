(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{49058:(o,e,n)=>{Promise.resolve().then(n.bind(n,51831)),Promise.resolve().then(n.t.bind(n,97536,23))},51831:(o,e,n)=>{"use strict";n.d(e,{default:()=>h});var t=n(90702),r=n(16576),c=n.n(r);n(97536);var a=n(16606),i=n(12609);function s(o){let{children:e,...n}=o;return(0,t.jsx)(i.N,{...n,children:e})}var l=n(96188),d=n(67259);function u(){let o=(0,d.d)(o=>o.loadConnections);return(0,a.useEffect)(()=>{console.log("StoreInitializer: Calling loadConnections on mount..."),o().then(()=>{console.log("StoreInitializer: loadConnections promise resolved.")}).catch(o=>{console.error("StoreInitializer: loadConnections promise rejected:",o)})},[]),null}function f(o){let{children:e}=o,n=(0,l.usePathname)(),r=null==n?void 0:n.startsWith("/canvas/");return(0,t.jsxs)("div",{className:"min-h-screen flex flex-col",children:[!r&&(0,t.jsx)("header",{className:"border-b py-4 px-6 bg-background",children:(0,t.jsx)("div",{className:"container mx-auto",children:(0,t.jsx)("h1",{className:"text-xl font-bold",children:"Sherlog Canvas"})})}),(0,t.jsx)("main",{className:"flex-1 ".concat(r?"":"container mx-auto py-6"),children:e})]})}function h(o){let{children:e}=o;return(0,t.jsxs)("html",{lang:"en",suppressHydrationWarning:!0,children:[(0,t.jsxs)("head",{children:[(0,t.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,t.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"}),(0,t.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400&family=IBM+Plex+Mono:wght@400;500;600&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap",rel:"stylesheet"})]}),(0,t.jsx)("body",{className:c().variable,children:(0,t.jsxs)(s,{attribute:"class",defaultTheme:"light",enableSystem:!0,children:[(0,t.jsx)(u,{}),(0,t.jsx)(f,{children:e})]})})]})}},67259:(o,e,n)=>{"use strict";n.d(e,{d:()=>a});var t=n(15367),r=n(21951),c=n(29809);let a=(0,t.v)()((0,r.lt)((0,r.Zr)((o,e)=>({connections:[],loading:!1,error:null,toolDefinitions:{},toolLoadingStatus:{},mcpStatuses:{},availableTypes:[],loadConnections:async()=>{console.log("useConnectionStore: loadConnections called"),o({loading:!0,error:null});let n=e().loadAvailableTypes();try{let n=await c.F.connections.list();if(!Array.isArray(n))throw console.error("API response for connections is not an array:",n),Error("Invalid data received from server.");let t=n.map(o=>{var e;return{...o,is_default:null!==(e=o.is_default)&&void 0!==e&&e}});o({connections:t,loading:!1}),[...new Set(t.map(o=>o.type))].forEach(o=>{e().toolLoadingStatus[o]&&"idle"!==e().toolLoadingStatus[o]&&"error"!==e().toolLoadingStatus[o]||e().fetchToolsForConnection(o)})}catch(e){console.error("Failed to load connections:",e),o({error:"Failed to load connections. Please try again.",loading:!1,connections:[]}),n.catch(o=>console.error("Error from concurrent loadAvailableTypes:",o))}},loadAvailableTypes:async()=>{try{let e=await c.F.connections.getTypes();o({availableTypes:e})}catch(e){console.error("Failed to load available connection types:",e),o(o=>({error:o.error||"Failed to load connection types."}))}},createConnection:async n=>{try{if(console.log("useConnectionStore: Calling unified api.connections.create"),!n.name||!n.type)throw Error("Connection name and type are required to create.");let{name:t,type:r,config:a,...i}=n,s={name:t,type:r,...a||{},...i},l=await c.F.connections.create(s);if(l){o(o=>({connections:[...o.connections,l]}));let n=e().toolLoadingStatus[l.type];return n&&"idle"!==n&&"error"!==n||e().fetchToolsForConnection(l.type),l}throw console.error("useConnectionStore: api.connections.create returned nullish value unexpectedly."),Error("Connection creation failed unexpectedly.")}catch(o){if(console.error("useConnectionStore: Failed to create connection:",o),o instanceof Error)throw o;throw Error("An unknown error occurred while creating the connection.")}},updateConnection:async(e,n)=>{try{if(!n.type)throw Error("Connection type is required for update.");let t=await c.F.connections.update(e,n);return o(o=>({connections:o.connections.map(o=>o.id===e?t:o)})),t}catch(o){return console.error("Failed to update connection:",o),null}},deleteConnection:async e=>{try{return await c.F.connections.delete(e),o(o=>({connections:o.connections.filter(o=>o.id!==e)})),!0}catch(o){return console.error("Failed to delete connection:",o),!1}},setDefaultConnection:async e=>{try{return await c.F.connections.setDefault(e),o(o=>({connections:o.connections.map(o=>({...o,is_default:o.id===e}))})),!0}catch(o){return console.error("Failed to set default connection:",o),!1}},testConnection:async o=>{try{if(!o.type)throw Error("Connection type is required for testing.");return await c.F.connections.test(o)}catch(o){return console.error("Failed to test connection:",o),{valid:!1,message:o instanceof Error?o.message:"Failed to test connection"}}},fetchToolsForConnection:async n=>{console.log("useConnectionStore: fetchToolsForConnection called for ".concat(n));let t=e().toolLoadingStatus[n];if("loading"===t||"success"===t){console.log("Skipping fetch for ".concat(n,", status: ").concat(t));return}o(o=>({toolLoadingStatus:{...o.toolLoadingStatus,[n]:"loading"}}));try{console.log("useConnectionStore: Attempting to fetch tools for ".concat(n,"..."));let e=await c.F.connections.getTools(n);console.log("useConnectionStore: Received tools for ".concat(n,":"),e),o(o=>(console.log("useConnectionStore: Setting definitions and status=success for ".concat(n)),{toolDefinitions:{...o.toolDefinitions,[n]:e},toolLoadingStatus:{...o.toolLoadingStatus,[n]:"success"}}))}catch(e){console.error("Failed to fetch tools for ".concat(n,":"),e),o(o=>(console.log("useConnectionStore: Setting status=error for ".concat(n)),{toolLoadingStatus:{...o.toolLoadingStatus,[n]:"error"}}))}},getConnectionsByType:o=>e().connections.filter(e=>e.type===o),getDefaultConnection:o=>{let n=e().getConnectionsByType(o);return n.find(o=>o.is_default)||n[0]||null}}),{name:"connection-store",partialize:o=>({})})))},97536:()=>{}},o=>{var e=e=>o(o.s=e);o.O(0,[688,190,994,215,809,393,685,358],()=>e(49058)),_N_E=o.O()}]);